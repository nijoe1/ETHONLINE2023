/*! For license information please see 581.ad04dc83.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunksafe_core_protocol_app=self.webpackChunksafe_core_protocol_app||[]).push([[581],{6581:function(t,r,n){n.r(r),n.d(r,{encodeToCurve:function(){return or},hashToCurve:function(){return ir},schnorr:function(){return tr},secp256k1:function(){return Ct}});var e={};n.r(e),n.d(e,{bitGet:function(){return D},bitLen:function(){return C},bitMask:function(){return F},bitSet:function(){return _},bytesToHex:function(){return I},bytesToNumberBE:function(){return O},bytesToNumberLE:function(){return R},concatBytes:function(){return U},createHmacDrbg:function(){return K},ensureBytes:function(){return N},equalBytes:function(){return H},hexToBytes:function(){return Z},hexToNumber:function(){return k},numberToBytesBE:function(){return q},numberToBytesLE:function(){return T},numberToHexUnpadded:function(){return A},numberToVarBytesBE:function(){return L},utf8ToBytes:function(){return P},validateObject:function(){return j}});var i=n(15671),o=n(43144),a=n(60136),u=n(29388),f=n(93433),s=n(95742),c=n(2626);var h=function(t){(0,a.Z)(n,t);var r=(0,u.Z)(n);function n(t,e,o,a){var u;return(0,i.Z)(this,n),(u=r.call(this)).blockLen=t,u.outputLen=e,u.padOffset=o,u.isLE=a,u.finished=!1,u.length=0,u.pos=0,u.destroyed=!1,u.buffer=new Uint8Array(t),u.view=(0,c.GL)(u.buffer),u}return(0,o.Z)(n,[{key:"update",value:function(t){s.ZP.exists(this);for(var r=this.view,n=this.buffer,e=this.blockLen,i=(t=(0,c.O0)(t)).length,o=0;o<i;){var a=Math.min(e-this.pos,i-o);if(a!==e)n.set(t.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===e&&(this.process(r,0),this.pos=0);else for(var u=(0,c.GL)(t);e<=i-o;o+=e)this.process(u,o)}return this.length+=t.length,this.roundClean(),this}},{key:"digestInto",value:function(t){s.ZP.exists(this),s.ZP.output(t,this),this.finished=!0;var r=this.buffer,n=this.view,e=this.blockLen,i=this.isLE,o=this.pos;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>e-o&&(this.process(n,0),o=0);for(var a=o;a<e;a++)r[a]=0;!function(t,r,n,e){if("function"===typeof t.setBigUint64)return t.setBigUint64(r,n,e);var i=BigInt(32),o=BigInt(4294967295),a=Number(n>>i&o),u=Number(n&o),f=e?4:0,s=e?0:4;t.setUint32(r+f,a,e),t.setUint32(r+s,u,e)}(n,e-8,BigInt(8*this.length),i),this.process(n,0);var u=(0,c.GL)(t),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen should be aligned to 32bit");var h=f/4,d=this.get();if(h>d.length)throw new Error("_sha2: outputLen bigger than state");for(var l=0;l<h;l++)u.setUint32(4*l,d[l],i)}},{key:"digest",value:function(){var t=this.buffer,r=this.outputLen;this.digestInto(t);var n=t.slice(0,r);return this.destroy(),n}},{key:"_cloneInto",value:function(t){var r;t||(t=new this.constructor),(r=t).set.apply(r,(0,f.Z)(this.get()));var n=this.blockLen,e=this.buffer,i=this.length,o=this.finished,a=this.destroyed,u=this.pos;return t.length=i,t.pos=u,t.finished=o,t.destroyed=a,i%n&&t.buffer.set(e),t}}]),n}(c.kb),d=function(t,r,n){return t&r^t&n^r&n},l=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),v=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),p=new Uint32Array(64),y=function(t){(0,a.Z)(n,t);var r=(0,u.Z)(n);function n(){var t;return(0,i.Z)(this,n),(t=r.call(this,64,32,8,!1)).A=0|v[0],t.B=0|v[1],t.C=0|v[2],t.D=0|v[3],t.E=0|v[4],t.F=0|v[5],t.G=0|v[6],t.H=0|v[7],t}return(0,o.Z)(n,[{key:"get",value:function(){return[this.A,this.B,this.C,this.D,this.E,this.F,this.G,this.H]}},{key:"set",value:function(t,r,n,e,i,o,a,u){this.A=0|t,this.B=0|r,this.C=0|n,this.D=0|e,this.E=0|i,this.F=0|o,this.G=0|a,this.H=0|u}},{key:"process",value:function(t,r){for(var n=0;n<16;n++,r+=4)p[n]=t.getUint32(r,!1);for(var e=16;e<64;e++){var i=p[e-15],o=p[e-2],a=(0,c.np)(i,7)^(0,c.np)(i,18)^i>>>3,u=(0,c.np)(o,17)^(0,c.np)(o,19)^o>>>10;p[e]=u+p[e-7]+a+p[e-16]|0}for(var f,s=this.A,h=this.B,v=this.C,y=this.D,g=this.E,w=this.F,m=this.G,b=this.H,E=0;E<64;E++){var B=b+((0,c.np)(g,6)^(0,c.np)(g,11)^(0,c.np)(g,25))+((f=g)&w^~f&m)+l[E]+p[E]|0,x=((0,c.np)(s,2)^(0,c.np)(s,13)^(0,c.np)(s,22))+d(s,h,v)|0;b=m,m=w,w=g,g=y+B|0,y=v,v=h,h=s,s=B+x|0}s=s+this.A|0,h=h+this.B|0,v=v+this.C|0,y=y+this.D|0,g=g+this.E|0,w=w+this.F|0,m=m+this.G|0,b=b+this.H|0,this.set(s,h,v,y,g,w,m,b)}},{key:"roundClean",value:function(){p.fill(0)}},{key:"destroy",value:function(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}]),n}(h),g=function(t){(0,a.Z)(n,t);var r=(0,u.Z)(n);function n(){var t;return(0,i.Z)(this,n),(t=r.call(this)).A=-1056596264,t.B=914150663,t.C=812702999,t.D=-150054599,t.E=-4191439,t.F=1750603025,t.G=1694076839,t.H=-1090891868,t.outputLen=28,t}return(0,o.Z)(n)}(y),w=(0,c.hE)((function(){return new y})),m=((0,c.hE)((function(){return new g})),n(29439)),b=BigInt(0),E=BigInt(1),B=BigInt(2),x=function(t){return t instanceof Uint8Array},S=Array.from({length:256},(function(t,r){return r.toString(16).padStart(2,"0")}));function I(t){if(!x(t))throw new Error("Uint8Array expected");for(var r="",n=0;n<t.length;n++)r+=S[t[n]];return r}function A(t){var r=t.toString(16);return 1&r.length?"0".concat(r):r}function k(t){if("string"!==typeof t)throw new Error("hex string expected, got "+typeof t);return BigInt(""===t?"0":"0x".concat(t))}function Z(t){if("string"!==typeof t)throw new Error("hex string expected, got "+typeof t);if(t.length%2)throw new Error("hex string is invalid: unpadded "+t.length);for(var r=new Uint8Array(t.length/2),n=0;n<r.length;n++){var e=2*n,i=t.slice(e,e+2),o=Number.parseInt(i,16);if(Number.isNaN(o)||o<0)throw new Error("invalid byte sequence");r[n]=o}return r}function O(t){return k(I(t))}function R(t){if(!x(t))throw new Error("Uint8Array expected");return k(I(Uint8Array.from(t).reverse()))}var q=function(t,r){return Z(t.toString(16).padStart(2*r,"0"))},T=function(t,r){return q(t,r).reverse()},L=function(t){return Z(A(t))};function N(t,r,n){var e;if("string"===typeof r)try{e=Z(r)}catch(o){throw new Error("".concat(t,' must be valid hex string, got "').concat(r,'". Cause: ').concat(o))}else{if(!x(r))throw new Error("".concat(t," must be hex string or Uint8Array"));e=Uint8Array.from(r)}var i=e.length;if("number"===typeof n&&i!==n)throw new Error("".concat(t," expected ").concat(n," bytes, got ").concat(i));return e}function U(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var e=new Uint8Array(r.reduce((function(t,r){return t+r.length}),0)),i=0;return r.forEach((function(t){if(!x(t))throw new Error("Uint8Array expected");e.set(t,i),i+=t.length})),e}function H(t,r){if(t.length!==r.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==r[n])return!1;return!0}function P(t){if("string"!==typeof t)throw new Error("utf8ToBytes expected string, got ".concat(typeof t));return(new TextEncoder).encode(t)}function C(t){var r;for(r=0;t>b;t>>=E,r+=1);return r}var D=function(t,r){return t>>BigInt(r)&E},_=function(t,r,n){return t|(n?E:b)<<BigInt(r)},F=function(t){return(B<<BigInt(t-1))-E},V=function(t){return new Uint8Array(t)},z=function(t){return Uint8Array.from(t)};function K(t,r,n){if("number"!==typeof t||t<2)throw new Error("hashLen must be a number");if("number"!==typeof r||r<2)throw new Error("qByteLen must be a number");if("function"!==typeof n)throw new Error("hmacFn must be a function");var e=V(t),i=V(t),o=0,a=function(){e.fill(1),i.fill(0),o=0},u=function(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return n.apply(void 0,[i,e].concat(r))},f=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V();i=u(z([0]),t),e=u(),0!==t.length&&(i=u(z([1]),t),e=u())},s=function(){if(o++>=1e3)throw new Error("drbg: tried 1000 values");for(var t=0,n=[];t<r;){var i=(e=u()).slice();n.push(i),t+=e.length}return U.apply(void 0,n)};return function(t,r){a(),f(t);for(var n=void 0;!(n=r(s()));)f();return a(),n}}var M={bigint:function(t){return"bigint"===typeof t},function:function(t){return"function"===typeof t},boolean:function(t){return"boolean"===typeof t},string:function(t){return"string"===typeof t},isSafeInteger:function(t){return Number.isSafeInteger(t)},array:function(t){return Array.isArray(t)},field:function(t,r){return r.Fp.isValid(t)},hash:function(t){return"function"===typeof t&&Number.isSafeInteger(t.outputLen)}};function j(t,r){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},e=function(r,n,e){var i=M[n];if("function"!==typeof i)throw new Error('Invalid validator "'.concat(n,'", expected function'));var o=t[r];if((!e||void 0!==o)&&!i(o,t))throw new Error("Invalid param ".concat(String(r),"=").concat(o," (").concat(typeof o,"), expected ").concat(n))},i=0,o=Object.entries(r);i<o.length;i++){var a=(0,m.Z)(o[i],2);e(a[0],a[1],!1)}for(var u=0,f=Object.entries(n);u<f.length;u++){var s=(0,m.Z)(f[u],2);e(s[0],s[1],!0)}return t}var G=BigInt(0),Y=BigInt(1),W=BigInt(2),X=BigInt(3),J=BigInt(4),Q=BigInt(5),$=BigInt(8);BigInt(9),BigInt(16);function tt(t,r){var n=t%r;return n>=G?n:r+n}function rt(t,r,n){if(n<=G||r<G)throw new Error("Expected power/modulo > 0");if(n===Y)return G;for(var e=Y;r>G;)r&Y&&(e=e*t%n),t=t*t%n,r>>=Y;return e}function nt(t,r,n){for(var e=t;r-- >G;)e*=e,e%=n;return e}function et(t,r){if(t===G||r<=G)throw new Error("invert: expected positive integers, got n=".concat(t," mod=").concat(r));for(var n=tt(t,r),e=r,i=G,o=Y,a=Y,u=G;n!==G;){var f=e/n,s=e%n,c=i-a*f,h=o-u*f;e=n,n=s,i=a,o=u,a=c,u=h}if(e!==Y)throw new Error("invert: does not exist");return tt(i,r)}function it(t){if(t%J===X){var r=(t+Y)/J;return function(t,n){var e=t.pow(n,r);if(!t.eql(t.sqr(e),n))throw new Error("Cannot find square root");return e}}if(t%$===Q){var n=(t-Q)/$;return function(t,r){var e=t.mul(r,W),i=t.pow(e,n),o=t.mul(r,i),a=t.mul(t.mul(o,W),i),u=t.mul(o,t.sub(a,t.ONE));if(!t.eql(t.sqr(u),r))throw new Error("Cannot find square root");return u}}return function(t){var r,n,e,i=(t-Y)/W;for(r=t-Y,n=0;r%W===G;r/=W,n++);for(e=W;e<t&&rt(e,i,t)!==t-Y;e++);if(1===n){var o=(t+Y)/J;return function(t,r){var n=t.pow(r,o);if(!t.eql(t.sqr(n),r))throw new Error("Cannot find square root");return n}}var a=(r+Y)/W;return function(t,o){if(t.pow(o,i)===t.neg(t.ONE))throw new Error("Cannot find square root");for(var u=n,f=t.pow(t.mul(t.ONE,e),r),s=t.pow(o,a),c=t.pow(o,r);!t.eql(c,t.ONE);){if(t.eql(c,t.ZERO))return t.ZERO;for(var h=1,d=t.sqr(c);h<u&&!t.eql(d,t.ONE);h++)d=t.sqr(d);var l=t.pow(f,Y<<BigInt(u-h-1));f=t.sqr(l),s=t.mul(s,l),c=t.mul(c,f),u=h}return s}}(t)}var ot=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function at(t){return j(t,ot.reduce((function(t,r){return t[r]="function",t}),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"}))}function ut(t,r){var n=void 0!==r?r:t.toString(2).length;return{nBitLength:n,nByteLength:Math.ceil(n/8)}}var ft=n(98737),st=n(1413),ct=BigInt(0),ht=BigInt(1);function dt(t){return at(t.Fp),j(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze((0,st.Z)((0,st.Z)((0,st.Z)({},ut(t.n,t.nBitLength)),t),{p:t.Fp.ORDER}))}var lt=O,vt=Z,pt={Err:function(t){(0,a.Z)(n,t);var r=(0,u.Z)(n);function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return(0,i.Z)(this,n),r.call(this,t)}return(0,o.Z)(n)}((0,ft.Z)(Error)),_parseInt:function(t){var r=pt.Err;if(t.length<2||2!==t[0])throw new r("Invalid signature integer tag");var n=t[1],e=t.subarray(2,n+2);if(!n||e.length!==n)throw new r("Invalid signature integer: wrong length");if(128&e[0])throw new r("Invalid signature integer: negative");if(0===e[0]&&!(128&e[1]))throw new r("Invalid signature integer: unnecessary leading zero");return{d:lt(e),l:t.subarray(n+2)}},toSig:function(t){var r=pt.Err,n="string"===typeof t?vt(t):t;if(!(n instanceof Uint8Array))throw new Error("ui8a expected");var e=n.length;if(e<2||48!=n[0])throw new r("Invalid signature tag");if(n[1]!==e-2)throw new r("Invalid signature: incorrect length");var i=pt._parseInt(n.subarray(2)),o=i.d,a=i.l,u=pt._parseInt(a),f=u.d;if(u.l.length)throw new r("Invalid signature: left bytes after parsing");return{r:o,s:f}},hexFromSig:function(t){var r=function(t){return 8&Number.parseInt(t[0],16)?"00"+t:t},n=function(t){var r=t.toString(16);return 1&r.length?"0".concat(r):r},e=r(n(t.s)),i=r(n(t.r)),o=e.length/2,a=i.length/2,u=n(o),f=n(a);return"30".concat(n(a+o+4),"02").concat(f).concat(i,"02").concat(u).concat(e)}},yt=BigInt(0),gt=BigInt(1),wt=BigInt(2),mt=BigInt(3),bt=BigInt(4);function Et(t){var r=function(t){var r=dt(t);j(r,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});var n=r.endo,e=r.Fp,i=r.a;if(n){if(!e.eql(i,e.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if("object"!==typeof n||"bigint"!==typeof n.beta||"function"!==typeof n.splitScalar)throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze((0,st.Z)({},r))}(t),n=r.Fp,e=r.toBytes||function(t,r,e){var i=r.toAffine();return U(Uint8Array.from([4]),n.toBytes(i.x),n.toBytes(i.y))},a=r.fromBytes||function(t){var r=t.subarray(1);return{x:n.fromBytes(r.subarray(0,n.BYTES)),y:n.fromBytes(r.subarray(n.BYTES,2*n.BYTES))}};function u(t){var e=r.a,i=r.b,o=n.sqr(t),a=n.mul(o,t);return n.add(n.add(a,n.mul(t,e)),i)}if(!n.eql(n.sqr(r.Gy),u(r.Gx)))throw new Error("bad generator point: equation left != right");function f(t){return"bigint"===typeof t&&yt<t&&t<r.n}function s(t){if(!f(t))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(t){var n,e=r.allowedPrivateKeyLengths,i=r.nByteLength,o=r.wrapPrivateKey,a=r.n;if(e&&"bigint"!==typeof t){if(t instanceof Uint8Array&&(t=I(t)),"string"!==typeof t||!e.includes(t.length))throw new Error("Invalid key");t=t.padStart(2*i,"0")}try{n="bigint"===typeof t?t:O(N("private key",t,i))}catch(u){throw new Error("private key must be ".concat(i," bytes, hex or bigint, not ").concat(typeof t))}return o&&(n=tt(n,a)),s(n),n}var h=new Map;function d(t){if(!(t instanceof l))throw new Error("ProjectivePoint expected")}var l=function(){function t(r,e,o){if((0,i.Z)(this,t),this.px=r,this.py=e,this.pz=o,null==r||!n.isValid(r))throw new Error("x required");if(null==e||!n.isValid(e))throw new Error("y required");if(null==o||!n.isValid(o))throw new Error("z required")}return(0,o.Z)(t,[{key:"x",get:function(){return this.toAffine().x}},{key:"y",get:function(){return this.toAffine().y}},{key:"_setWindowSize",value:function(t){this._WINDOW_SIZE=t,h.delete(this)}},{key:"assertValidity",value:function(){if(this.is0()){if(r.allowInfinityPoint)return;throw new Error("bad point: ZERO")}var t=this.toAffine(),e=t.x,i=t.y;if(!n.isValid(e)||!n.isValid(i))throw new Error("bad point: x or y not FE");var o=n.sqr(i),a=u(e);if(!n.eql(o,a))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}},{key:"hasEvenY",value:function(){var t=this.toAffine().y;if(n.isOdd)return!n.isOdd(t);throw new Error("Field doesn't support isOdd")}},{key:"equals",value:function(t){d(t);var r=this.px,e=this.py,i=this.pz,o=t.px,a=t.py,u=t.pz,f=n.eql(n.mul(r,u),n.mul(o,i)),s=n.eql(n.mul(e,u),n.mul(a,i));return f&&s}},{key:"negate",value:function(){return new t(this.px,n.neg(this.py),this.pz)}},{key:"double",value:function(){var e=r.a,i=r.b,o=n.mul(i,mt),a=this.px,u=this.py,f=this.pz,s=n.ZERO,c=n.ZERO,h=n.ZERO,d=n.mul(a,a),l=n.mul(u,u),v=n.mul(f,f),p=n.mul(a,u);return p=n.add(p,p),h=n.mul(a,f),h=n.add(h,h),s=n.mul(e,h),c=n.mul(o,v),c=n.add(s,c),s=n.sub(l,c),c=n.add(l,c),c=n.mul(s,c),s=n.mul(p,s),h=n.mul(o,h),v=n.mul(e,v),p=n.sub(d,v),p=n.mul(e,p),p=n.add(p,h),h=n.add(d,d),d=n.add(h,d),d=n.add(d,v),d=n.mul(d,p),c=n.add(c,d),v=n.mul(u,f),v=n.add(v,v),d=n.mul(v,p),s=n.sub(s,d),h=n.mul(v,l),h=n.add(h,h),new t(s,c,h=n.add(h,h))}},{key:"add",value:function(e){d(e);var i=this.px,o=this.py,a=this.pz,u=e.px,f=e.py,s=e.pz,c=n.ZERO,h=n.ZERO,l=n.ZERO,v=r.a,p=n.mul(r.b,mt),y=n.mul(i,u),g=n.mul(o,f),w=n.mul(a,s),m=n.add(i,o),b=n.add(u,f);m=n.mul(m,b),b=n.add(y,g),m=n.sub(m,b),b=n.add(i,a);var E=n.add(u,s);return b=n.mul(b,E),E=n.add(y,w),b=n.sub(b,E),E=n.add(o,a),c=n.add(f,s),E=n.mul(E,c),c=n.add(g,w),E=n.sub(E,c),l=n.mul(v,b),c=n.mul(p,w),l=n.add(c,l),c=n.sub(g,l),l=n.add(g,l),h=n.mul(c,l),g=n.add(y,y),g=n.add(g,y),w=n.mul(v,w),b=n.mul(p,b),g=n.add(g,w),w=n.sub(y,w),w=n.mul(v,w),b=n.add(b,w),y=n.mul(g,b),h=n.add(h,y),y=n.mul(E,b),c=n.mul(m,c),c=n.sub(c,y),y=n.mul(m,g),l=n.mul(E,l),new t(c,h,l=n.add(l,y))}},{key:"subtract",value:function(t){return this.add(t.negate())}},{key:"is0",value:function(){return this.equals(t.ZERO)}},{key:"wNAF",value:function(r){return p.wNAFCached(this,h,r,(function(r){var e=n.invertBatch(r.map((function(t){return t.pz})));return r.map((function(t,r){return t.toAffine(e[r])})).map(t.fromAffine)}))}},{key:"multiplyUnsafe",value:function(e){var i=t.ZERO;if(e===yt)return i;if(s(e),e===gt)return this;var o=r.endo;if(!o)return p.unsafeLadder(this,e);for(var a=o.splitScalar(e),u=a.k1neg,f=a.k1,c=a.k2neg,h=a.k2,d=i,l=i,v=this;f>yt||h>yt;)f&gt&&(d=d.add(v)),h&gt&&(l=l.add(v)),v=v.double(),f>>=gt,h>>=gt;return u&&(d=d.negate()),c&&(l=l.negate()),l=new t(n.mul(l.px,o.beta),l.py,l.pz),d.add(l)}},{key:"multiply",value:function(e){s(e);var i,o,a=e,u=r.endo;if(u){var f=u.splitScalar(a),c=f.k1neg,h=f.k1,d=f.k2neg,l=f.k2,v=this.wNAF(h),y=v.p,g=v.f,w=this.wNAF(l),m=w.p,b=w.f;y=p.constTimeNegate(c,y),m=p.constTimeNegate(d,m),m=new t(n.mul(m.px,u.beta),m.py,m.pz),i=y.add(m),o=g.add(b)}else{var E=this.wNAF(a);i=E.p,o=E.f}return t.normalizeZ([i,o])[0]}},{key:"multiplyAndAddUnsafe",value:function(r,n,e){var i=t.BASE,o=function(t,r){return r!==yt&&r!==gt&&t.equals(i)?t.multiply(r):t.multiplyUnsafe(r)},a=o(this,n).add(o(r,e));return a.is0()?void 0:a}},{key:"toAffine",value:function(t){var r=this.px,e=this.py,i=this.pz,o=this.is0();null==t&&(t=o?n.ONE:n.inv(i));var a=n.mul(r,t),u=n.mul(e,t),f=n.mul(i,t);if(o)return{x:n.ZERO,y:n.ZERO};if(!n.eql(f,n.ONE))throw new Error("invZ was invalid");return{x:a,y:u}}},{key:"isTorsionFree",value:function(){var n=r.h,e=r.isTorsionFree;if(n===gt)return!0;if(e)return e(t,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}},{key:"clearCofactor",value:function(){var n=r.h,e=r.clearCofactor;return n===gt?this:e?e(t,this):this.multiplyUnsafe(r.h)}},{key:"toRawBytes",value:function(){var r=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.assertValidity(),e(t,this,r)}},{key:"toHex",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return I(this.toRawBytes(t))}}],[{key:"fromAffine",value:function(r){var e=r||{},i=e.x,o=e.y;if(!r||!n.isValid(i)||!n.isValid(o))throw new Error("invalid affine point");if(r instanceof t)throw new Error("projective point not allowed");var a=function(t){return n.eql(t,n.ZERO)};return a(i)&&a(o)?t.ZERO:new t(i,o,n.ONE)}},{key:"normalizeZ",value:function(r){var e=n.invertBatch(r.map((function(t){return t.pz})));return r.map((function(t,r){return t.toAffine(e[r])})).map(t.fromAffine)}},{key:"fromHex",value:function(r){var n=t.fromAffine(a(N("pointHex",r)));return n.assertValidity(),n}},{key:"fromPrivateKey",value:function(r){return t.BASE.multiply(c(r))}}]),t}();l.BASE=new l(r.Gx,r.Gy,n.ONE),l.ZERO=new l(n.ZERO,n.ONE,n.ZERO);var v=r.nBitLength,p=function(t,r){var n=function(t,r){var n=r.negate();return t?n:r},e=function(t){return{windows:Math.ceil(r/t)+1,windowSize:Math.pow(2,t-1)}};return{constTimeNegate:n,unsafeLadder:function(r,n){for(var e=t.ZERO,i=r;n>ct;)n&ht&&(e=e.add(i)),i=i.double(),n>>=ht;return e},precomputeWindow:function(t,r){for(var n=e(r),i=n.windows,o=n.windowSize,a=[],u=t,f=u,s=0;s<i;s++){f=u,a.push(f);for(var c=1;c<o;c++)f=f.add(u),a.push(f);u=f.double()}return a},wNAF:function(r,i,o){for(var a=e(r),u=a.windows,f=a.windowSize,s=t.ZERO,c=t.BASE,h=BigInt(Math.pow(2,r)-1),d=Math.pow(2,r),l=BigInt(r),v=0;v<u;v++){var p=v*f,y=Number(o&h);o>>=l,y>f&&(y-=d,o+=ht);var g=p,w=p+Math.abs(y)-1,m=v%2!==0,b=y<0;0===y?c=c.add(n(m,i[g])):s=s.add(n(b,i[w]))}return{p:s,f:c}},wNAFCached:function(t,r,n,e){var i=t._WINDOW_SIZE||1,o=r.get(t);return o||(o=this.precomputeWindow(t,i),1!==i&&r.set(t,e(o))),this.wNAF(i,o,n)}}}(l,r.endo?Math.ceil(v/2):v);return{CURVE:r,ProjectivePoint:l,normPrivateKeyToScalar:c,weierstrassEquation:u,isWithinCurveOrder:f}}function Bt(t){var r=function(t){var r=dt(t);return j(r,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze((0,st.Z)({lowS:!0},r))}(t),n=r.Fp,a=r.n,u=n.BYTES+1,f=2*n.BYTES+1;function s(t){return tt(t,a)}function c(t){return et(t,a)}var h=Et((0,st.Z)((0,st.Z)({},r),{},{toBytes:function(t,r,e){var i=r.toAffine(),o=n.toBytes(i.x),a=U;return e?a(Uint8Array.from([r.hasEvenY()?2:3]),o):a(Uint8Array.from([4]),o,n.toBytes(i.y))},fromBytes:function(t){var r=t.length,e=t[0],i=t.subarray(1);if(r!==u||2!==e&&3!==e){if(r===f&&4===e)return{x:n.fromBytes(i.subarray(0,n.BYTES)),y:n.fromBytes(i.subarray(n.BYTES,2*n.BYTES))};throw new Error("Point of length ".concat(r," was invalid. Expected ").concat(u," compressed bytes or ").concat(f," uncompressed bytes"))}var o=O(i);if(!(yt<(a=o)&&a<n.ORDER))throw new Error("Point is not on curve");var a,s=v(o),c=n.sqrt(s);return 1===(1&e)!==((c&gt)===gt)&&(c=n.neg(c)),{x:o,y:c}}})),d=h.ProjectivePoint,l=h.normPrivateKeyToScalar,v=h.weierstrassEquation,p=h.isWithinCurveOrder,y=function(t){return I(q(t,r.nByteLength))};function g(t){return t>a>>gt}var w=function(t,r,n){return O(t.slice(r,n))},m=function(){function t(r,n,e){(0,i.Z)(this,t),this.r=r,this.s=n,this.recovery=e,this.assertValidity()}return(0,o.Z)(t,[{key:"assertValidity",value:function(){if(!p(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!p(this.s))throw new Error("s must be 0 < s < CURVE.n")}},{key:"addRecoveryBit",value:function(r){return new t(this.r,this.s,r)}},{key:"recoverPublicKey",value:function(t){var e=this.r,i=this.s,o=this.recovery,a=x(N("msgHash",t));if(null==o||![0,1,2,3].includes(o))throw new Error("recovery id invalid");var u=2===o||3===o?e+r.n:e;if(u>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");var f=0===(1&o)?"02":"03",h=d.fromHex(f+y(u)),l=c(u),v=s(-a*l),p=s(i*l),g=d.BASE.multiplyAndAddUnsafe(h,v,p);if(!g)throw new Error("point at infinify");return g.assertValidity(),g}},{key:"hasHighS",value:function(){return g(this.s)}},{key:"normalizeS",value:function(){return this.hasHighS()?new t(this.r,s(-this.s),this.recovery):this}},{key:"toDERRawBytes",value:function(){return Z(this.toDERHex())}},{key:"toDERHex",value:function(){return pt.hexFromSig({r:this.r,s:this.s})}},{key:"toCompactRawBytes",value:function(){return Z(this.toCompactHex())}},{key:"toCompactHex",value:function(){return y(this.r)+y(this.s)}}],[{key:"fromCompact",value:function(n){var e=r.nByteLength;return n=N("compactSignature",n,2*e),new t(w(n,0,e),w(n,e,2*e))}},{key:"fromDER",value:function(r){var n=pt.toSig(N("DER",r));return new t(n.r,n.s)}}]),t}(),b={isValidPrivateKey:function(t){try{return l(t),!0}catch(r){return!1}},normPrivateKeyToScalar:l,randomPrivateKey:function(){var t=function(t,r){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],e=(t=N("privateHash",t)).length,i=ut(r).nByteLength+8;if(i<24||e<i||e>1024)throw new Error("hashToPrivateScalar: expected ".concat(i,"-1024 bytes of input, got ").concat(e));return tt(n?R(t):O(t),r-Y)+Y}(r.randomBytes(n.BYTES+8),a);return q(t,r.nByteLength)},precompute:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d.BASE;return r._setWindowSize(t),r.multiply(BigInt(3)),r}};function E(t){var r=t instanceof Uint8Array,n="string"===typeof t,e=(r||n)&&t.length;return r?e===u||e===f:n?e===2*u||e===2*f:t instanceof d}var B=r.bits2int||function(t){var n=O(t),e=8*t.length-r.nBitLength;return e>0?n>>BigInt(e):n},x=r.bits2int_modN||function(t){return s(B(t))},S=F(r.nBitLength);function A(t){if("bigint"!==typeof t)throw new Error("bigint expected");if(!(yt<=t&&t<S))throw new Error("bigint expected < 2^".concat(r.nBitLength));return q(t,r.nByteLength)}function k(t,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:T;if(["recovered","canonical"].some((function(t){return t in o})))throw new Error("sign() legacy options not supported");var a=r.hash,u=r.randomBytes,f=o.lowS,h=o.prehash,v=o.extraEntropy;null==f&&(f=!0),t=N("msgHash",t),h&&(t=N("prehashed msgHash",a(t)));var y=x(t),w=l(i),b=[A(w),A(y)];if(null!=v){var E=!0===v?u(n.BYTES):v;b.push(N("extraEntropy",E,n.BYTES))}var S=U.apply(e,b),I=y;return{seed:S,k2sig:function(t){var r=B(t);if(p(r)){var n=c(r),e=d.BASE.multiply(r).toAffine(),i=s(e.x);if(i!==yt){var o=s(n*s(I+i*w));if(o!==yt){var a=(e.x===i?0:2)|Number(e.y&gt),u=o;return f&&g(o)&&(u=function(t){return g(t)?s(-t):t}(o),a^=1),new m(i,u,a)}}}}}}var T={lowS:r.lowS,prehash:!1},L={lowS:r.lowS,prehash:!1};return d.BASE._setWindowSize(8),{CURVE:r,getPublicKey:function(t){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return d.fromPrivateKey(t).toRawBytes(r)},getSharedSecret:function(t,r){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(E(t))throw new Error("first arg must be private key");if(!E(r))throw new Error("second arg must be public key");return d.fromHex(r).multiply(l(t)).toRawBytes(n)},sign:function(t,n){var e=k(t,n,arguments.length>2&&void 0!==arguments[2]?arguments[2]:T),i=e.seed,o=e.k2sig;return K(r.hash.outputLen,r.nByteLength,r.hmac)(i,o)},verify:function(t,n,e){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:L,a=t;if(n=N("msgHash",n),e=N("publicKey",e),"strict"in o)throw new Error("options.strict was renamed to lowS");var u,f=o.lowS,h=o.prehash,l=void 0;try{if("string"===typeof a||a instanceof Uint8Array)try{l=m.fromDER(a)}catch(A){if(!(A instanceof pt.Err))throw A;l=m.fromCompact(a)}else{if("object"!==typeof a||"bigint"!==typeof a.r||"bigint"!==typeof a.s)throw new Error("PARSE");var v=a.r,p=a.s;l=new m(v,p)}u=d.fromHex(e)}catch(k){if("PARSE"===k.message)throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(f&&l.hasHighS())return!1;h&&(n=r.hash(n));var y=l,g=y.r,w=y.s,b=x(n),E=c(w),B=s(b*E),S=s(g*E),I=null===(i=d.BASE.multiplyAndAddUnsafe(u,B,S))||void 0===i?void 0:i.toAffine();return!!I&&s(I.x)===g},ProjectivePoint:d,Signature:m,utils:b}}var xt=O;function St(t,r){if(t<0||t>=1<<8*r)throw new Error("bad I2OSP call: value=".concat(t," length=").concat(r));for(var n=Array.from({length:r}).fill(0),e=r-1;e>=0;e--)n[e]=255&t,t>>>=8;return new Uint8Array(n)}function It(t,r){for(var n=new Uint8Array(t.length),e=0;e<t.length;e++)n[e]=t[e]^r[e];return n}function At(t){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected")}function kt(t){if(!Number.isSafeInteger(t))throw new Error("number expected")}function Zt(t,r,n){j(n,{DST:"string",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});var e=n.p,i=n.k,o=n.m,a=n.hash,u=n.expand,f=n.DST;At(t),kt(r);var s,c=function(t){if(t instanceof Uint8Array)return t;if("string"===typeof t)return P(t);throw new Error("DST must be Uint8Array or string")}(f),h=e.toString(2).length,d=Math.ceil((h+i)/8),l=r*o*d;if("xmd"===u)s=function(t,r,n,e){At(t),At(r),kt(n),r.length>255&&(r=e(U(P("H2C-OVERSIZE-DST-"),r)));var i=e.outputLen,o=e.blockLen,a=Math.ceil(n/i);if(a>255)throw new Error("Invalid xmd length");var u=U(r,St(r.length,1)),f=St(0,o),s=St(n,2),c=new Array(a),h=e(U(f,t,s,St(0,1),u));c[0]=e(U(h,St(1,1),u));for(var d=1;d<=a;d++){var l=[It(h,c[d-1]),St(d+1,1),u];c[d]=e(U.apply(void 0,l))}return U.apply(void 0,c).slice(0,n)}(t,c,l,a);else if("xof"===u)s=function(t,r,n,e,i){if(At(t),At(r),kt(n),r.length>255){var o=Math.ceil(2*e/8);r=i.create({dkLen:o}).update(P("H2C-OVERSIZE-DST-")).update(r).digest()}if(n>65535||r.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return i.create({dkLen:n}).update(t).update(St(n,2)).update(r).update(St(r.length,1)).digest()}(t,c,l,i,a);else{if("_internal_pass"!==u)throw new Error('expand must be "xmd" or "xof"');s=t}for(var v=new Array(r),p=0;p<r;p++){for(var y=new Array(o),g=0;g<o;g++){var w=d*(g+p*o),m=s.subarray(w,w+d);y[g]=tt(xt(m),e)}v[p]=y}return v}var Ot=function(t){(0,a.Z)(n,t);var r=(0,u.Z)(n);function n(t,e){var o;(0,i.Z)(this,n),(o=r.call(this)).finished=!1,o.destroyed=!1,s.ZP.hash(t);var a=(0,c.O0)(e);if(o.iHash=t.create(),"function"!==typeof o.iHash.update)throw new TypeError("Expected instance of class which extends utils.Hash");o.blockLen=o.iHash.blockLen,o.outputLen=o.iHash.outputLen;var u=o.blockLen,f=new Uint8Array(u);f.set(a.length>u?t.create().update(a).digest():a);for(var h=0;h<f.length;h++)f[h]^=54;o.iHash.update(f),o.oHash=t.create();for(var d=0;d<f.length;d++)f[d]^=106;return o.oHash.update(f),f.fill(0),o}return(0,o.Z)(n,[{key:"update",value:function(t){return s.ZP.exists(this),this.iHash.update(t),this}},{key:"digestInto",value:function(t){s.ZP.exists(this),s.ZP.bytes(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}},{key:"digest",value:function(){var t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}},{key:"_cloneInto",value:function(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));var r=this.oHash,n=this.iHash,e=this.finished,i=this.destroyed,o=this.blockLen,a=this.outputLen;return t.finished=e,t.destroyed=i,t.blockLen=o,t.outputLen=a,t.oHash=r._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}},{key:"destroy",value:function(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}]),n}(c.kb),Rt=function(t,r,n){return new Ot(t,r).update(n).digest()};Rt.create=function(t,r){return new Ot(t,r)};var qt=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Tt=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),Lt=BigInt(1),Nt=BigInt(2),Ut=function(t,r){return(t+r/Nt)/r};function Ht(t){var r=qt,n=BigInt(3),e=BigInt(6),i=BigInt(11),o=BigInt(22),a=BigInt(23),u=BigInt(44),f=BigInt(88),s=t*t*t%r,c=s*s*t%r,h=nt(c,n,r)*c%r,d=nt(h,n,r)*c%r,l=nt(d,Nt,r)*s%r,v=nt(l,i,r)*l%r,p=nt(v,o,r)*v%r,y=nt(p,u,r)*p%r,g=nt(y,f,r)*y%r,w=nt(g,u,r)*p%r,m=nt(w,n,r)*c%r,b=nt(m,a,r)*v%r,E=nt(b,e,r)*s%r,B=nt(E,Nt,r);if(!Pt.eql(Pt.sqr(B),t))throw new Error("Cannot find square root");return B}var Pt=function(t,r){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(t<=G)throw new Error("Expected Fp ORDER > 0, got ".concat(t));var i=ut(t,r),o=i.nBitLength,a=i.nByteLength;if(a>2048)throw new Error("Field lengths over 2048 bytes are not supported");var u=it(t),f=Object.freeze({ORDER:t,BITS:o,BYTES:a,MASK:F(o),ZERO:G,ONE:Y,create:function(r){return tt(r,t)},isValid:function(r){if("bigint"!==typeof r)throw new Error("Invalid field element: expected bigint, got ".concat(typeof r));return G<=r&&r<t},is0:function(t){return t===G},isOdd:function(t){return(t&Y)===Y},neg:function(r){return tt(-r,t)},eql:function(t,r){return t===r},sqr:function(r){return tt(r*r,t)},add:function(r,n){return tt(r+n,t)},sub:function(r,n){return tt(r-n,t)},mul:function(r,n){return tt(r*n,t)},pow:function(t,r){return function(t,r,n){if(n<G)throw new Error("Expected power > 0");if(n===G)return t.ONE;if(n===Y)return r;for(var e=t.ONE,i=r;n>G;)n&Y&&(e=t.mul(e,i)),i=t.sqr(i),n>>=Y;return e}(f,t,r)},div:function(r,n){return tt(r*et(n,t),t)},sqrN:function(t){return t*t},addN:function(t,r){return t+r},subN:function(t,r){return t-r},mulN:function(t,r){return t*r},inv:function(r){return et(r,t)},sqrt:e.sqrt||function(t){return u(f,t)},invertBatch:function(t){return function(t,r){var n=new Array(r.length),e=r.reduce((function(r,e,i){return t.is0(e)?r:(n[i]=r,t.mul(r,e))}),t.ONE),i=t.inv(e);return r.reduceRight((function(r,e,i){return t.is0(e)?r:(n[i]=t.mul(r,n[i]),t.mul(r,e))}),i),n}(f,t)},cmov:function(t,r,n){return n?r:t},toBytes:function(t){return n?T(t,a):q(t,a)},fromBytes:function(t){if(t.length!==a)throw new Error("Fp.fromBytes: expected ".concat(a,", got ").concat(t.length));return n?R(t):O(t)}});return Object.freeze(f)}(qt,void 0,void 0,{sqrt:Ht}),Ct=function(t,r){var n=function(r){return Bt((0,st.Z)((0,st.Z)({},t),function(t){return{hash:t,hmac:function(r){for(var n=arguments.length,e=new Array(n>1?n-1:0),i=1;i<n;i++)e[i-1]=arguments[i];return Rt(t,r,c.eV.apply(void 0,e))},randomBytes:c.O6}}(r)))};return Object.freeze((0,st.Z)((0,st.Z)({},n(r)),{},{create:n}))}({a:BigInt(0),b:BigInt(7),Fp:Pt,n:Tt,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:function(t){var r=Tt,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),e=-Lt*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),o=n,a=BigInt("0x100000000000000000000000000000000"),u=Ut(o*t,r),f=Ut(-e*t,r),s=tt(t-u*n-f*i,r),c=tt(-u*e-f*o,r),h=s>a,d=c>a;if(h&&(s=r-s),d&&(c=r-c),s>a||c>a)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:h,k1:s,k2neg:d,k2:c}}}},w),Dt=BigInt(0),_t=function(t){return"bigint"===typeof t&&Dt<t&&t<qt},Ft=function(t){return"bigint"===typeof t&&Dt<t&&t<Tt},Vt={};function zt(t){var r=Vt[t];if(void 0===r){var n=w(Uint8Array.from(t,(function(t){return t.charCodeAt(0)})));r=U(n,n),Vt[t]=r}for(var e=arguments.length,i=new Array(e>1?e-1:0),o=1;o<e;o++)i[o-1]=arguments[o];return w(U.apply(void 0,[r].concat(i)))}var Kt=function(t){return t.toRawBytes(!0).slice(1)},Mt=function(t){return q(t,32)},jt=function(t){return tt(t,qt)},Gt=function(t){return tt(t,Tt)},Yt=Ct.ProjectivePoint,Wt=function(t,r,n){return Yt.BASE.multiplyAndAddUnsafe(t,r,n)};function Xt(t){var r=Ct.utils.normPrivateKeyToScalar(t),n=Yt.fromPrivateKey(r);return{scalar:n.hasEvenY()?r:Gt(-r),bytes:Kt(n)}}function Jt(t){if(!_t(t))throw new Error("bad x: need 0 < x < p");var r=jt(t*t),n=Ht(jt(r*t+BigInt(7)));n%Nt!==Dt&&(n=jt(-n));var e=new Yt(t,n,Lt);return e.assertValidity(),e}function Qt(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Gt(O(zt.apply(void 0,["BIP0340/challenge"].concat(r))))}function $t(t,r,n){var e=N("signature",t,64),i=N("message",r),o=N("publicKey",n,32);try{var a=Jt(O(o)),u=O(e.subarray(0,32));if(!_t(u))return!1;var f=O(e.subarray(32,64));if(!Ft(f))return!1;var s=Qt(Mt(u),Kt(a),i),c=Wt(a,f,Gt(-s));return!(!c||!c.hasEvenY()||c.toAffine().x!==u)}catch(h){return!1}}var tr={getPublicKey:function(t){return Xt(t).bytes},sign:function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(0,c.O6)(32),e=N("message",t),i=Xt(r),o=i.bytes,a=i.scalar,u=N("auxRand",n,32),f=Mt(a^O(zt("BIP0340/aux",u))),s=zt("BIP0340/nonce",f,o,e),h=Gt(O(s));if(h===Dt)throw new Error("sign failed: k is zero");var d=Xt(h),l=d.bytes,v=d.scalar,p=Qt(l,o,e),y=new Uint8Array(64);if(y.set(l,0),y.set(Mt(Gt(v+p*a)),32),!$t(y,e,o))throw new Error("sign: Invalid signature produced");return y},verify:$t,utils:{randomPrivateKey:Ct.utils.randomPrivateKey,lift_x:Jt,pointToBytes:Kt,numberToBytesBE:q,bytesToNumberBE:O,taggedHash:zt,mod:tt}},rr=function(t,r){var n=r.map((function(t){return Array.from(t).reverse()}));return function(r,e){var i=n.map((function(n){return n.reduce((function(n,e){return t.add(t.mul(n,r),e)}))})),o=(0,m.Z)(i,4),a=o[0],u=o[1],f=o[2],s=o[3];return r=t.div(a,u),e=t.mul(e,t.div(f,s)),{x:r,y:e}}}(Pt,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map((function(t){return t.map((function(t){return BigInt(t)}))}))),nr=function(t,r){if(at(t),!t.isValid(r.A)||!t.isValid(r.B)||!t.isValid(r.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");var n=function(t,r){for(var n=t.ORDER,e=yt,i=n-gt;i%wt===yt;i/=wt)e+=gt;var o=e,a=(n-gt)/Math.pow(wt,o),u=(a-gt)/wt,f=Math.pow(wt,o)-gt,s=Math.pow(wt,o-gt),c=t.pow(r,a),h=t.pow(r,(a+gt)/wt),d=function(r,n){var e=c,i=t.pow(n,f),a=t.sqr(i);a=t.mul(a,n);var d=t.mul(r,a);d=t.pow(d,u),d=t.mul(d,i),i=t.mul(d,n),a=t.mul(d,r);var l=t.mul(a,i);d=t.pow(l,s);var v=t.eql(d,t.ONE);i=t.mul(a,h),d=t.mul(l,e),a=t.cmov(i,a,v),l=t.cmov(d,l,v);for(var p=o;p>gt;p--){var y=Math.pow(wt,p-wt),g=t.pow(l,y),w=t.eql(g,t.ONE);i=t.mul(a,e),e=t.mul(e,e),g=t.mul(l,e),a=t.cmov(i,a,w),l=t.cmov(g,l,w)}return{isValid:v,value:a}};if(t.ORDER%bt===mt){var l=(t.ORDER-mt)/bt,v=t.sqrt(t.neg(r));d=function(r,n){var e=t.sqr(n),i=t.mul(r,n);e=t.mul(e,i);var o=t.pow(e,l);o=t.mul(o,i);var a=t.mul(o,v),u=t.mul(t.sqr(o),n),f=t.eql(u,r);return{isValid:f,value:t.cmov(a,o,f)}}}return d}(t,r.Z);if(!t.isOdd)throw new Error("Fp.isOdd is not implemented!");return function(e){var i,o,a,u,f,s,c,h;i=t.sqr(e),i=t.mul(i,r.Z),o=t.sqr(i),o=t.add(o,i),a=t.add(o,t.ONE),a=t.mul(a,r.B),u=t.cmov(r.Z,t.neg(o),!t.eql(o,t.ZERO)),u=t.mul(u,r.A),o=t.sqr(a),s=t.sqr(u),f=t.mul(s,r.A),o=t.add(o,f),o=t.mul(o,a),s=t.mul(s,u),f=t.mul(s,r.B),o=t.add(o,f),c=t.mul(i,a);var d=n(o,s),l=d.isValid,v=d.value;h=t.mul(i,e),h=t.mul(h,v),c=t.cmov(c,a,l),h=t.cmov(h,v,l);var p=t.isOdd(e)===t.isOdd(h);return h=t.cmov(t.neg(h),h,p),{x:c=t.div(c,u),y:h}}}(Pt,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:Pt.create(BigInt("-11"))}),er=function(t,r,n){if("function"!==typeof r)throw new Error("mapToCurve() must be defined");return{hashToCurve:function(e,i){var o=Zt(e,2,(0,st.Z)((0,st.Z)({},n),{},{DST:n.DST},i)),a=t.fromAffine(r(o[0])),u=t.fromAffine(r(o[1])),f=a.add(u).clearCofactor();return f.assertValidity(),f},encodeToCurve:function(e,i){var o=Zt(e,1,(0,st.Z)((0,st.Z)({},n),{},{DST:n.encodeDST},i)),a=t.fromAffine(r(o[0])).clearCofactor();return a.assertValidity(),a}}}(Ct.ProjectivePoint,(function(t){var r=nr(Pt.create(t[0])),n=r.x,e=r.y;return rr(n,e)}),{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:Pt.ORDER,m:1,k:128,expand:"xmd",hash:w}),ir=er.hashToCurve,or=er.encodeToCurve}}]);
//# sourceMappingURL=581.ad04dc83.chunk.js.map